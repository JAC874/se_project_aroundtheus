!function(){"use strict";class e{constructor(e,t,s){let{name:i,link:n}=e;this._name=i,this._link=n,this._cardSelector=t,this._handleImageClick=s}_setEventListeners(){this._likeBtn.addEventListener("click",this._handleLikeIcon.bind(this)),this._deleteBtn.addEventListener("click",this._handleDeleteCard.bind(this)),this._cardImageEl.addEventListener("click",(()=>{this._handleImageClick(this._name,this._link)}))}_handleLikeIcon(){this._likeBtn.classList.toggle("card__like-button_active")}_handleDeleteCard(){this._cardElement.remove(),this._cardElement=null}getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._likeBtn=this._cardElement.querySelector(".card__like-button"),this._deleteBtn=this._cardElement.querySelector(".card__delete-button"),this._cardImageEl=this._cardElement.querySelector(".card__image"),this._cardTitleEl=this._cardElement.querySelector(".card__title"),this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name,this._cardTitleEl.textContent=this._name,this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){this._errorMessageEl=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorMessageEl.textContent=e.validationMessage,this._errorMessageEl.classList.add(this._errorClass)}_hideInputError(e){this._errorMessageEl=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorMessageEl.textContent="",this._errorMessageEl.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleButtonState(){this._hasInvalidInput(this._inputEls)?this._disableButton():this._enableButton()}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault(e),this._disableButton()})),this._setEventListeners()}resetValidation(){this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}}const s={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__edit-save-button",inactiveButtonClass:"modal__edit-save-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},i=(document.querySelector("#profile-edit-modal"),document.querySelector("#profile-edit-button")),n=(document.querySelector("#profile-title"),document.querySelector("#profile-description"),document.querySelector("#profile-title-input")),r=document.querySelector("#profile-description-input"),o=document.forms["profile-form"],l=document.querySelector("#add-card-modal"),a=document.querySelector("#add-button"),c=(document.forms["add-card-form"],document.querySelector("#preview-image-modal"));document.querySelector(".modal__preview-image"),c.querySelector(".modal__preview-caption");class d{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._closeButton=this._popupElement.querySelector(".modal__close"),this._handleEscClose=this._handleEscClose.bind(this),this._handleOverlayClick=this._handleOverlayClick.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleOverlayClick(e){e.target===e.currentTarget&&this.close()}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._closeButton.addEventListener("click",(()=>this.close())),this._popupElement.addEventListener("click",this._handleOverlayClick)}}class u extends d{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._setEventListeners()}_getInputValues(){const e=this._popupForm.querySelectorAll(".modal__input"),t={};return e.forEach((e=>{const{name:s,value:i}=e;t[s]=i})),t}_setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this._popupForm.reset(),this.close()}))}}const _=new class extends d{constructor(e){super({popupSelector:e}),this._imageElement=this._popupElement.querySelector(".modal__preview-image"),this._imageCaption=this._popupElement.querySelector(".modal__preview-caption")}open(e){let{name:t,link:s}=e;this._imageElement.src=s,this._imageElement.alt=t,this._imageCaption.textContent=t,super.open()}}("#preview-image-modal");function h(e,t){_.open({name:e,link:t})}function m(t){return new e(t,"#card-template",h).getView()}_.setEventListeners();const p=new class{constructor(e){let{name:t,description:s}=e;this._title=document.querySelector(t),this._description=document.querySelector(s)}getUserInfo(){return{title:this._title.textContent,description:this._description.textContent}}setUserInfo(e){this._title.textContent=e.title,this._description.textContent=e.description}}({name:".profile__title",description:".profile__description"}),E=new u("#profile-edit-modal",(e=>{p.setUserInfo({title:e.title,description:e.description})}));E.setEventListeners(),i.addEventListener("click",(()=>{S.resetValidation();const e=p.getUserInfo();n.value=e.title,r.value=e.description.trim(),E.open()}));const v=new u("#add-card-modal",(e=>{g.addItem(m({name:e.title,link:e.link}))}));v.setEventListeners(),a.addEventListener("click",(()=>{v.open(),y._disableButton()}));const g=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:e=>{const t=m(e);g.addItem(t)}},".cards__list");g.renderItems([{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}]);const S=new t(s,o),y=new t(s,l);S.enableValidation(),y.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0VOLFNBQVdLLElBQ1QsTUFBTUcsRUFBYzNCLEVBQVd3QixHQUMvQlQsRUFBWUMsUUFBUVcsRUFBWSxHSFRaLGdCR2UxQlosRUFBWU8sWUhyRWdCLENBQzFCLENBQ0U3SCxLQUFNLGtCQUNOQyxLQUFNLHNHQUVSLENBQ0VELEtBQU0sY0FDTkMsS0FBTSx5R0FFUixDQUNFRCxLQUFNLGlCQUNOQyxLQUFNLDRHQUVSLENBQ0VELEtBQU0sVUFDTkMsS0FBTSxxR0FFUixDQUNFRCxLQUFNLHdCQUNOQyxLQUFNLHFHQUVSLENBQ0VELEtBQU0saUJBQ05DLEtBQU0sb0dHaURWLE1BQU1pSCxFQUF1QixJQUFJdEYsRUFDL0JxRixFQUNBQSxHQUVJTyxFQUFtQixJQUFJNUYsRUFDM0JxRixFQUNBQSxHQUdGQyxFQUFxQm5ELG1CQUNyQnlELEVBQWlCekQsa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWUsIGxpbmsgfSwgY2FyZFNlbGVjdG9yLCBoYW5kbGVJbWFnZUNsaWNrKSB7XG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gICAgdGhpcy5fbGluayA9IGxpbms7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2xpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUxpa2VJY29uLmJpbmQodGhpcykpO1xuICAgIHRoaXMuX2RlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgXCJjbGlja1wiLFxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZC5iaW5kKHRoaXMpXG4gICAgKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKTtcbiAgICB9KTtcbiAgfVxuXG4gIF9oYW5kbGVMaWtlSWNvbigpIHtcbiAgICB0aGlzLl9saWtlQnRuLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gIH1cblxuICBfaGFuZGxlRGVsZXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICB0aGlzLl9saWtlQnRuID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9kZWxldGVCdG4gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XG4gICAgdGhpcy5fY2FyZEltYWdlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtRWwpIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlnLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IGNvbmZpZy5lcnJvckNsYXNzO1xuXG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbDtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbCkge1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfVxuXG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xuICAgIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbCkgPT4gIWlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xuICB9XG5cbiAgX2Rpc2FibGVCdXR0b24oKSB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgfVxuXG4gIF9lbmFibGVCdXR0b24oKSB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dEVscykpIHtcbiAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XG4gICAgfVxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2lucHV0RWxzID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoZXZ0KTtcbiAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXG4gIH0sXG5dO1xuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2VkaXQtc2F2ZS1idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fZWRpdC1zYXZlLWJ1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuLy8gZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcbi8vICAgcG9wdXBGb3JtOiBcIm1vZGFsX19mb3JtXCIsXG4vLyAgIHByZXZpZXdJbWFnZTogXCJtb2RhbF9fcHJldmlldy1pbWFnZVwiLFxuLy8gICBhZGRDYXJkTW9kYWw6IFwiI2FkZC1jYXJkLW1vZGFsXCIsXG4vLyB9O1xuXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uXCJcbik7XG5leHBvcnQgY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdGl0bGUtaW5wdXRcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcbik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWZvcm1cIl07XG5cbmV4cG9ydCBjb25zdCBjYXJkTGlzdEVsID0gXCIuY2FyZHNfX2xpc3RcIjtcblxuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiYWRkLWNhcmQtZm9ybVwiXTtcblxuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LWltYWdlLW1vZGFsXCIpO1xuZXhwb3J0IGNvbnN0IHByZXZpZXdJbWFnZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9fcHJldmlldy1pbWFnZVwiXG4pO1xuZXhwb3J0IGNvbnN0IHByZXZpZXdDYXB0aW9uID0gcHJldmlld0ltYWdlTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX3ByZXZpZXctY2FwdGlvblwiXG4pO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2hhbmRsZU92ZXJsYXlDbGljayA9IHRoaXMuX2hhbmRsZU92ZXJsYXlDbGljay5iaW5kKHRoaXMpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlT3ZlcmxheUNsaWNrKGV2dCkge1xuICAgIGlmIChldnQudGFyZ2V0ID09PSBldnQuY3VycmVudFRhcmdldCkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLmNsb3NlKCkpO1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlT3ZlcmxheUNsaWNrKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBpbnB1dExpc3QgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XG4gICAgY29uc3QgaW5wdXRJdGVtcyA9IHt9O1xuICAgIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgY29uc3QgeyBuYW1lLCB2YWx1ZSB9ID0gaW5wdXQ7XG4gICAgICBpbnB1dEl0ZW1zW25hbWVdID0gdmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIGlucHV0SXRlbXM7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgKiBhcyBjb25zdGFudHMgZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5cbi8vIEluaXRpYWxpemUgdGhlIHBvcHVwIGZvciBpbWFnZSBwcmV2aWV3XG5jb25zdCBjYXJkUHJldmlldyA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNwcmV2aWV3LWltYWdlLW1vZGFsXCIpO1xuY2FyZFByZXZpZXcuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhuYW1lLCBsaW5rKSB7XG4gIGNhcmRQcmV2aWV3Lm9wZW4oeyBuYW1lLCBsaW5rIH0pO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gbmV3IENhcmQoY2FyZERhdGEsIFwiI2NhcmQtdGVtcGxhdGVcIiwgaGFuZGxlSW1hZ2VDbGljayk7XG4gIHJldHVybiBjYXJkRWxlbWVudC5nZXRWaWV3KCk7XG59XG5cbi8vIEluaXRpYWxpemUgdXNlciBpbmZvcm1hdGlvblxuY29uc3QgdXNlckluZm9ybWF0aW9uID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZTogXCIucHJvZmlsZV9fdGl0bGVcIixcbiAgZGVzY3JpcHRpb246IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXG59KTtcblxuLy8gSW5pdGlhbGl6ZSBwcm9maWxlIGVkaXQgZm9ybVxuY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsIChkYXRhKSA9PiB7XG4gIHVzZXJJbmZvcm1hdGlvbi5zZXRVc2VySW5mbyh7XG4gICAgdGl0bGU6IGRhdGEudGl0bGUsXG4gICAgZGVzY3JpcHRpb246IGRhdGEuZGVzY3JpcHRpb24sXG4gIH0pO1xufSk7XG5wcm9maWxlRWRpdEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gQWRkIGV2ZW50IGxpc3RlbmVyIGZvciB0aGUgcHJvZmlsZSBlZGl0IGJ1dHRvblxuY29uc3RhbnRzLnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHByb2ZpbGVFZGl0VmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xuICBjb25zdCB1c2VyRGF0YSA9IHVzZXJJbmZvcm1hdGlvbi5nZXRVc2VySW5mbygpO1xuICBjb25zdGFudHMucHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSB1c2VyRGF0YS50aXRsZTtcbiAgY29uc3RhbnRzLnByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdXNlckRhdGEuZGVzY3JpcHRpb24udHJpbSgpO1xuICBwcm9maWxlRWRpdEZvcm0ub3BlbigpO1xufSk7XG5cbi8vIEluaXRpYWxpemUgdGhlIGFkZCBjYXJkIGZvcm1cbmNvbnN0IGFkZENhcmRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYWRkLWNhcmQtbW9kYWxcIiwgKGRhdGEpID0+IHtcbiAgY2FyZFNlY3Rpb24uYWRkSXRlbShjcmVhdGVDYXJkKHsgbmFtZTogZGF0YS50aXRsZSwgbGluazogZGF0YS5saW5rIH0pKTtcbn0pO1xuYWRkQ2FyZEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gQWRkIGV2ZW50IGxpc3RlbmVyIGZvciB0aGUgYWRkIGNhcmQgYnV0dG9uXG5jb25zdGFudHMuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhZGRDYXJkRm9ybS5vcGVuKCk7XG4gIGFkZENhcmRWYWxpZGF0b3IuX2Rpc2FibGVCdXR0b24oKTtcbn0pO1xuXG4vLyBJbml0aWFsaXplIHRoZSBjYXJkIHNlY3Rpb24gYW5kIHJlbmRlciBpbml0aWFsIGNhcmRzXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICB7XG4gICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoaXRlbSk7XG4gICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICB9LFxuICB9LFxuICBjb25zdGFudHMuY2FyZExpc3RFbFxuKTtcblxuY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoY29uc3RhbnRzLmluaXRpYWxDYXJkcyk7XG5cbi8vIEluaXRpYWxpemUgZm9ybSB2YWxpZGF0b3JzXG5jb25zdCBwcm9maWxlRWRpdFZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICBjb25zdGFudHMuY29uZmlnLFxuICBjb25zdGFudHMucHJvZmlsZUVkaXRGb3JtXG4pO1xuY29uc3QgYWRkQ2FyZFZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICBjb25zdGFudHMuY29uZmlnLFxuICBjb25zdGFudHMuYWRkQ2FyZE1vZGFsXG4pO1xuXG5wcm9maWxlRWRpdFZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hZGRDYXJkVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLm1vZGFsX19wcmV2aWV3LWltYWdlXCJcbiAgICApO1xuICAgIHRoaXMuX2ltYWdlQ2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIubW9kYWxfX3ByZXZpZXctY2FwdGlvblwiXG4gICAgKTtcbiAgfVxuXG4gIG9wZW4oeyBuYW1lLCBsaW5rIH0pIHtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuc3JjID0gbGluaztcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWx0ID0gbmFtZTtcbiAgICB0aGlzLl9pbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWUsIGRlc2NyaXB0aW9uIH0pIHtcbiAgICB0aGlzLl90aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZSk7XG4gICAgdGhpcy5fZGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRlc2NyaXB0aW9uKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIGNvbnN0IHVzZXJJbmZvID0ge1xuICAgICAgdGl0bGU6IHRoaXMuX3RpdGxlLnRleHRDb250ZW50LFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2Rlc2NyaXB0aW9uLnRleHRDb250ZW50LFxuICAgIH07XG4gICAgcmV0dXJuIHVzZXJJbmZvO1xuICB9XG5cbiAgc2V0VXNlckluZm8oZGF0YSkge1xuICAgIHRoaXMuX3RpdGxlLnRleHRDb250ZW50ID0gZGF0YS50aXRsZTtcbiAgICB0aGlzLl9kZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEuZGVzY3JpcHRpb247XG4gIH1cbn1cbiIsImltcG9ydCB7IGNhcmRMaXN0RWwgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICAvLyB0aGlzLl9jb250YWluZXJTZWxlY3RvciA9IFwiLmNhcmRMaXN0RWxcIjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwibmFtZSIsImxpbmsiLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnRuIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVMaWtlSWNvbiIsImJpbmQiLCJfZGVsZXRlQnRuIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJfY2FyZEltYWdlRWwiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJfY2FyZEVsZW1lbnQiLCJyZW1vdmUiLCJnZXRWaWV3IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9jYXJkVGl0bGVFbCIsInNyYyIsImFsdCIsInRleHRDb250ZW50IiwiRm9ybVZhbGlkYXRvciIsImNvbmZpZyIsImZvcm1FbCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsIl9lcnJvck1lc3NhZ2VFbCIsImlkIiwiYWRkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJpbnB1dExpc3QiLCJzb21lIiwiX2Rpc2FibGVCdXR0b24iLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2lucHV0RWxzIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJmb3JtU2VsZWN0b3IiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJwcm9maWxlRWRpdEZvcm0iLCJmb3JtcyIsImFkZENhcmRNb2RhbCIsImFkZENhcmRCdXR0b24iLCJwcmV2aWV3SW1hZ2VNb2RhbCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfY2xvc2VCdXR0b24iLCJfaGFuZGxlRXNjQ2xvc2UiLCJfaGFuZGxlT3ZlcmxheUNsaWNrIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dEl0ZW1zIiwiaW5wdXQiLCJ2YWx1ZSIsImUiLCJyZXNldCIsImNhcmRQcmV2aWV3IiwiX2ltYWdlRWxlbWVudCIsIl9pbWFnZUNhcHRpb24iLCJjcmVhdGVDYXJkIiwiY2FyZERhdGEiLCJ1c2VySW5mb3JtYXRpb24iLCJkZXNjcmlwdGlvbiIsIl90aXRsZSIsIl9kZXNjcmlwdGlvbiIsImdldFVzZXJJbmZvIiwidGl0bGUiLCJzZXRVc2VySW5mbyIsImRhdGEiLCJjb25zdGFudHMiLCJwcm9maWxlRWRpdFZhbGlkYXRvciIsInVzZXJEYXRhIiwidHJpbSIsImFkZENhcmRGb3JtIiwiY2FyZFNlY3Rpb24iLCJhZGRJdGVtIiwiYWRkQ2FyZFZhbGlkYXRvciIsImNvbnRhaW5lclNlbGVjdG9yIiwicmVuZGVyZXIiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtcyIsIml0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsImNhcmRFbGVtZW50Il0sInNvdXJjZVJvb3QiOiIifQ==