!function(){"use strict";class e{constructor(e,t,r,s,i){this.name=e.name,this.link=e.link,this._cardSelector=t,this._handleImageClick=r,this._cardID=e._id,this._handleDeleteCard=s,this._handleLikeButton=i,this.isLiked=e.isLiked}_setEventListeners(){this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this.isLiked&&this._likeButton.classList.add("card__like-button_active"),this._likeButton.addEventListener("click",(e=>{e.preventDefault(),e.target===this._likeButton&&this._handleLikeButton(this._likeButton,this.isLiked,this._cardID).then((e=>{this.isLiked=e,this._updateLikeButton()})).catch((e=>console.error("Error toggling like:",e)))})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteCard(this._cardID,this._cardElement)})),this._cardImageEl.addEventListener("click",(()=>{this._handleImageClick(this.name,this.link)}))}_updateLikeButton(){this.isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardImageEl=this._cardElement.querySelector(".card__image"),this._cardTitleEl=this._cardElement.querySelector(".card__title"),this._cardImageEl.src=this.link,this._cardImageEl.alt=this.name,this._cardTitleEl.textContent=this.name,this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){this._errorMessageEl=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorMessageEl.textContent=e.validationMessage,this._errorMessageEl.classList.add(this._errorClass)}_hideInputError(e){this._errorMessageEl=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorMessageEl.textContent="",this._errorMessageEl.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_toggleButtonState(){this._hasInvalidInput(this._inputEls)?this._disableButton():this._enableButton()}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault(e)})),this._setEventListeners(),this._toggleButtonState()}resetValidation(){this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}}class r{constructor(e,t){let{items:r,renderer:s}=e;this._renderer=s,this._items=r,this._container=document.querySelector(t)}renderItems(){this._items.reverse().forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}const s={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__edit-save-button",inactiveButtonClass:"modal__edit-save-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},i=(document.querySelector("#profile-edit-modal"),document.querySelector("#profile-edit-button")),o=(document.querySelector("#profile-title"),document.querySelector("#profile-description"),document.querySelector("#edit-avatar-modal-form")),n=document.querySelector("#profile-title-input"),a=document.querySelector("#profile-description-input"),l=document.forms["profile-form"],d=document.querySelector("#add-card-modal"),c=document.querySelector("#add-button"),h=(document.forms["add-card-form"],document.querySelector("#preview-image-modal"));document.querySelector(".modal__preview-image"),h.querySelector(".modal__preview-caption");class u{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._closeButton=this._popupElement.querySelector(".modal__close"),this._handleEscClose=this._handleEscClose.bind(this),this._handleOverlayClick=this._handleOverlayClick.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleOverlayClick(e){e.target===e.currentTarget&&this.close()}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._closeButton.addEventListener("click",(()=>this.close())),this._popupElement.addEventListener("click",this._handleOverlayClick)}}class _ extends u{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._submitButton=this._popupForm.querySelector(".modal__edit-save-button"),this._submitButtonText=this._submitButton.textContent,this._setEventListeners()}_getInputValues(){this._inputElements=this._popupForm.querySelectorAll(".modal__input");const e={};return this._inputElements.forEach((t=>{e[t.name]=t.value})),e}reset(){this._popupForm.reset()}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}_setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}}const m=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addCard(e,t){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUser(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editProfile(e,t){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteRequest(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers,body:JSON.stringify({isLiked:!0})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}removeLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers,body:JSON.stringify({isLiked:!1})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updateAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"73b28af1-3d27-47c6-87e4-d9eade98f6bf","content-type":"application/json"}}),p=new t(s,l),E=new t(s,d);let v;function b(t){return new e(t,"#card-template",k,C,B).getView()}new t(s,o).enableValidation(),p.enableValidation(),E.enableValidation(),m.getInitialCards().then((e=>{v=new r({items:e,renderer:e=>{const t=b(e);v.addItem(t)}},".cards__list"),v.renderItems()})).catch((e=>console.error(e)));const f=new _("#add-card-modal",(function(e){f.renderLoading(!0),m.addCard(e.name,e.link).then((e=>{const t=b(e);v.addItem(t),f.close(),f.reset(),E._disableButton(),f.close()})).catch((e=>{console.error("Error adding card:",e)})).finally((()=>{f.renderLoading(!1)}))}));f.setEventListeners(),c.addEventListener("click",(()=>{f.open(),E._disableButton()}));const g=new class extends u{constructor(e){super({popupSelector:e}),this._imageElement=this._popupElement.querySelector(".modal__preview-image"),this._imageCaption=this._popupElement.querySelector(".modal__preview-caption")}open(e){let{name:t,link:r}=e;this._imageElement.src=r,this._imageElement.alt=t,this._imageCaption.textContent=t,super.open()}}("#preview-image-modal");function k(e,t){g.open({name:e,link:t})}g.setEventListeners();const L=new _("#delete-card-modal",(()=>{m.deleteRequest(S).then((()=>{y.remove(),L.close()})).catch((e=>console.error("Error deleting card:",e)))}));let S=null,y=null;function C(e,t){S=e,y=t,L.open()}function B(e,t,r){return t?m.removeLike(r).then((()=>(e.classList.remove("card__like-button_active"),!1))).catch((e=>console.error("Error removing like:",e))):m.addLike(r).then((()=>(e.classList.add("card__like-button_active"),!0))).catch((e=>console.error("Error adding like:",e)))}const q=new class{constructor(e,t,r){this._name=document.querySelector(e),this._about=document.querySelector(t),this._avatar=document.querySelector(r)}getUserInfo(){return{name:this._name.textContent,about:this._about.textContent}}setUserInfo(e,t){this._name.textContent=e,this._about.textContent=t}setAvatar(e){this._avatar.src=e}}(".profile__title",".profile__description",".profile__image");m.getUser().then((e=>{q.setUserInfo(e.name,e.about),q.setAvatar(e.avatar)})).catch((e=>console.error("Error fetching user data:",e)));const I=new _("#profile-edit-modal",(function(e){I.renderLoading(!0),m.editProfile(e.name,e.about).then((e=>{q.setUserInfo(e.name,e.about),I.close()})).catch((e=>console.error("Error editing profile:",e))).finally((()=>{I.renderLoading(!1)}))}));I.setEventListeners(),i.addEventListener("click",(()=>{const e=q.getUserInfo();n.value=e.name,a.value=e.about,I.open()})),document.querySelector(".profile__image-pencil").addEventListener("click",(e=>{e.target===e.currentTarget&&w.open()}));const w=new _("#edit-avatar-modal",(function(e){let{link:t}=e;w.renderLoading(!0),m.updateAvatar(t).then((e=>{console.log("Avatar updated successfully:",e),q.setAvatar(t),w.close(),w.reset()})).catch((e=>{console.error("Error occurred while updating avatar:",e)})).finally((()=>{w.renderLoading(!1)}))}));w.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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a0wsRUFBU0ksY0FDdEJyQixFQUFBQSxNQUFvQ2pLLEVBQUtNLEtBQ3pDMkosRUFBQUEsTUFBMENqSyxFQUFLd0osTUFDL0N2RCxFQUFnQlksTUFBTSxJQUtGM0UsU0FBU2hCLGNBQWMsMEJBRS9CSSxpQkFBaUIsU0FBVUMsSUFDbkNBLEVBQUVFLFNBQVdGLEVBQUV5RixlQUNqQnlFLEVBQWdCNUUsTUFDbEIsSUFHRixNQUFNNEUsRUFBa0IsSUFBSXRFLEVBQzFCLHNCQUtGLFNBQTJCbEMsR0FBVyxJQUFWLEtBQUUxRSxHQUFNMEUsRUFDbEN3RyxFQUFnQjNELGVBQWMsR0FDOUJNLEVBQ0d5QixhQUFhdEosR0FDYm1CLE1BQU1pSCxJQUNMN0csUUFBUTRKLElBQUksK0JBQWdDL0MsR0FDNUN1QyxFQUFTTSxVQUFVakwsR0FDbkJrTCxFQUFnQjNFLFFBQ2hCMkUsRUFBZ0I1RCxPQUFPLElBRXhCakcsT0FBTzJJLElBQ056SSxRQUFRRCxNQUFNLHdDQUF5QzBJLEVBQUksSUFFNURFLFNBQVEsS0FDUGdCLEVBQWdCM0QsZUFBYyxFQUFNLEdBRTFDLElBbEJBMkQsRUFBZ0J2RSxtQiIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICBkYXRhLFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNhcmQsXG4gICAgaGFuZGxlTGlrZUJ1dHRvblxuICApIHtcbiAgICB0aGlzLm5hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgICB0aGlzLl9jYXJkSUQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkID0gaGFuZGxlRGVsZXRlQ2FyZDtcbiAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uID0gaGFuZGxlTGlrZUJ1dHRvbjtcbiAgICB0aGlzLmlzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIlxuICAgICk7XG4gICAgaWYgKHRoaXMuaXNMaWtlZCkge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH1cblxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgIGlmIChlLnRhcmdldCA9PT0gdGhpcy5fbGlrZUJ1dHRvbikge1xuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKHRoaXMuX2xpa2VCdXR0b24sIHRoaXMuaXNMaWtlZCwgdGhpcy5fY2FyZElEKVxuICAgICAgICAgIC50aGVuKChpc0xpa2VkKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmlzTGlrZWQgPSBpc0xpa2VkO1xuICAgICAgICAgICAgdGhpcy5fdXBkYXRlTGlrZUJ1dHRvbigpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yIHRvZ2dsaW5nIGxpa2U6XCIsIGVycm9yKSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQodGhpcy5fY2FyZElELCB0aGlzLl9jYXJkRWxlbWVudCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzLm5hbWUsIHRoaXMubGluayk7XG4gICAgfSk7XG4gIH1cblxuICBfdXBkYXRlTGlrZUJ1dHRvbigpIHtcbiAgICBpZiAodGhpcy5pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9XG4gIH1cblxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgdGhpcy5fY2FyZFRpdGxlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsLnNyYyA9IHRoaXMubGluaztcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5hbHQgPSB0aGlzLm5hbWU7XG4gICAgdGhpcy5fY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSB0aGlzLm5hbWU7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbCkge1xuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IGNvbmZpZy5mb3JtU2VsZWN0b3I7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9XG5cbiAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSB7XG4gICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsKSA9PiAhaW5wdXRFbC52YWxpZGl0eS52YWxpZCk7XG4gIH1cblxuICBfZGlzYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICB9XG5cbiAgX2VuYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0RWxzKSkge1xuICAgICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdChldnQpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2l0ZW1zLnJldmVyc2UoKS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZEl0ZW0oaXRlbSkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW0pO1xuICB9XG59XG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcbiAgfSxcbl07XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fZWRpdC1zYXZlLWJ1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19lZGl0LXNhdmUtYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG59O1xuXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uXCJcbik7XG5leHBvcnQgY29uc3QgZWRpdEF2YXRhckZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtYXZhdGFyLW1vZGFsLWZvcm1cIik7XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcInByb2ZpbGUtZm9ybVwiXTtcblxuZXhwb3J0IGNvbnN0IGNhcmRMaXN0RWwgPSBcIi5jYXJkc19fbGlzdFwiO1xuXG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJhZGQtY2FyZC1mb3JtXCJdO1xuXG5leHBvcnQgY29uc3QgcHJldmlld0ltYWdlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctaW1hZ2UtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgcHJldmlld0ltYWdlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19wcmV2aWV3LWltYWdlXCJcbik7XG5leHBvcnQgY29uc3QgcHJldmlld0NhcHRpb24gPSBwcmV2aWV3SW1hZ2VNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIi5tb2RhbF9fcHJldmlldy1jYXB0aW9uXCJcbik7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5faGFuZGxlT3ZlcmxheUNsaWNrID0gdGhpcy5faGFuZGxlT3ZlcmxheUNsaWNrLmJpbmQodGhpcyk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIF9oYW5kbGVPdmVybGF5Q2xpY2soZXZ0KSB7XG4gICAgaWYgKGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuY2xvc2UoKSk7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVPdmVybGF5Q2xpY2spO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLm1vZGFsX19lZGl0LXNhdmUtYnV0dG9uXCJcbiAgICApO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XG5cbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIGlucHV0VmFsdWVzW2lucHV0RWwubmFtZV0gPSBpbnB1dEVsLnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG4gIHJlc2V0KCkge1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICB9XG5cbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gYFNhdmluZy4uLmApIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dDtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuIiwiLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIGltcG9ydCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0ICogYXMgY29uc3RhbnRzIGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcblxuLy8gQVBJXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCI3M2IyOGFmMS0zZDI3LTQ3YzYtODdlNC1kOWVhZGU5OGY2YmZcIixcbiAgICBcImNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuLy8tLS0tLS0tRk9STSBWQUxJREFUSU9OLS0tLS0vL1xuXG4vLyBJbml0aWFsaXplIGZvcm0gdmFsaWRhdG9yc1xuY29uc3QgcHJvZmlsZUVkaXRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgY29uc3RhbnRzLmNvbmZpZyxcbiAgY29uc3RhbnRzLnByb2ZpbGVFZGl0Rm9ybVxuKTtcbmNvbnN0IGFkZENhcmRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgY29uc3RhbnRzLmNvbmZpZyxcbiAgY29uc3RhbnRzLmFkZENhcmRNb2RhbFxuKTtcblxuY29uc3QgZWRpdEF2YXRhckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgY29uc3RhbnRzLmNvbmZpZyxcbiAgY29uc3RhbnRzLmVkaXRBdmF0YXJGb3JtXG4pO1xuXG5lZGl0QXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5wcm9maWxlRWRpdFZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hZGRDYXJkVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxubGV0IGNhcmRTZWN0aW9uO1xuYXBpXG4gIC5nZXRJbml0aWFsQ2FyZHMoKVxuICAudGhlbigoY2FyZERhdGEpID0+IHtcbiAgICBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgICAge1xuICAgICAgICBpdGVtczogY2FyZERhdGEsXG4gICAgICAgIHJlbmRlcmVyOiAoY2FyZERhdGEpID0+IHtcbiAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xuICAgICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIFwiLmNhcmRzX19saXN0XCJcbiAgICApO1xuICAgIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpO1xuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkRGF0YSxcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVEZWxldGVDYXJkLFxuICAgIGhhbmRsZUxpa2VCdXR0b25cbiAgKTtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkLmdldFZpZXcoKTtcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xufVxuXG4vLyBBREQgTkVXIENBUkQgRk9STVxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQoZGF0YSkge1xuICBhZGRDYXJkRm9ybS5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBhcGlcbiAgICAuYWRkQ2FyZChkYXRhLm5hbWUsIGRhdGEubGluaylcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGRhdGEpO1xuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XG4gICAgICBhZGRDYXJkRm9ybS5jbG9zZSgpO1xuICAgICAgYWRkQ2FyZEZvcm0ucmVzZXQoKTtcbiAgICAgIGFkZENhcmRWYWxpZGF0b3IuX2Rpc2FibGVCdXR0b24oKTtcbiAgICAgIGFkZENhcmRGb3JtLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgYWRkaW5nIGNhcmQ6XCIsIGVycm9yKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGFkZENhcmRGb3JtLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuXG5jb25zdCBhZGRDYXJkRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNhZGQtY2FyZC1tb2RhbFwiLFxuICBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdFxuKTtcbmFkZENhcmRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIEVWRU5UIExJU1RFTkVSIEZPUiBORVcgQ0FSRCBCVVRUT05cbmNvbnN0YW50cy5hZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZENhcmRGb3JtLm9wZW4oKTtcbiAgYWRkQ2FyZFZhbGlkYXRvci5fZGlzYWJsZUJ1dHRvbigpO1xufSk7XG5cbi8vIFBSRVZJRVcgSU1BR0UgTU9EQUxcbmNvbnN0IGNhcmRQcmV2aWV3ID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI3ByZXZpZXctaW1hZ2UtbW9kYWxcIik7XG5jYXJkUHJldmlldy5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKG5hbWUsIGxpbmspIHtcbiAgY2FyZFByZXZpZXcub3Blbih7IG5hbWUsIGxpbmsgfSk7XG59XG5cbmNvbnN0IGRlbGV0ZUNhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI2RlbGV0ZS1jYXJkLW1vZGFsXCIsICgpID0+IHtcbiAgYXBpXG4gICAgLmRlbGV0ZVJlcXVlc3QoY3VycmVudENhcmRJRClcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBjdXJyZW50Q2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gICAgICBkZWxldGVDYXJkUG9wdXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyb3IpID0+IGNvbnNvbGUuZXJyb3IoXCJFcnJvciBkZWxldGluZyBjYXJkOlwiLCBlcnJvcikpO1xufSk7XG5cbmxldCBjdXJyZW50Q2FyZElEID0gbnVsbDtcbmxldCBjdXJyZW50Q2FyZEVsZW1lbnQgPSBudWxsO1xuXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmRJRCwgY2FyZEVsZW1lbnQpIHtcbiAgY3VycmVudENhcmRJRCA9IGNhcmRJRDtcbiAgY3VycmVudENhcmRFbGVtZW50ID0gY2FyZEVsZW1lbnQ7XG4gIGRlbGV0ZUNhcmRQb3B1cC5vcGVuKCk7XG59XG5cbi8vLS0tLS1IQU5ETEUgTElLRVMtLS0tL1xuXG5mdW5jdGlvbiBoYW5kbGVMaWtlQnV0dG9uKGxpa2VCdXR0b24sIGxpa2VkU3RhdHVzLCBjYXJkSUQpIHtcbiAgaWYgKGxpa2VkU3RhdHVzKSB7XG4gICAgcmV0dXJuIGFwaVxuICAgICAgLnJlbW92ZUxpa2UoY2FyZElEKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBsaWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3IgcmVtb3ZpbmcgbGlrZTpcIiwgZXJyb3IpKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYXBpXG4gICAgICAuYWRkTGlrZShjYXJkSUQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGxpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yIGFkZGluZyBsaWtlOlwiLCBlcnJvcikpO1xuICB9XG59XG4vLy0tLS0tLS0tLS1VU0VSIElORk8tLS0tLS0vL1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhcbiAgXCIucHJvZmlsZV9fdGl0bGVcIixcbiAgXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbiAgXCIucHJvZmlsZV9faW1hZ2VcIlxuKTtcblxuYXBpXG4gIC5nZXRVc2VyKClcbiAgLnRoZW4oKGlucHV0VmFsdWVzKSA9PiB7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oaW5wdXRWYWx1ZXMubmFtZSwgaW5wdXRWYWx1ZXMuYWJvdXQpO1xuICAgIHVzZXJJbmZvLnNldEF2YXRhcihpbnB1dFZhbHVlcy5hdmF0YXIpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIHVzZXIgZGF0YTpcIiwgZXJyKSk7XG5cbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0KGlucHV0VmFsdWVzKSB7XG4gIHByb2ZpbGVFZGl0Rm9ybS5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBhcGlcbiAgICAuZWRpdFByb2ZpbGUoaW5wdXRWYWx1ZXMubmFtZSwgaW5wdXRWYWx1ZXMuYWJvdXQpXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEubmFtZSwgZGF0YS5hYm91dCk7XG4gICAgICBwcm9maWxlRWRpdEZvcm0uY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3IgZWRpdGluZyBwcm9maWxlOlwiLCBlcnIpKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHByb2ZpbGVFZGl0Rm9ybS5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn1cblxuLy8gRURJVCBVU0VSIEZPUk1cbmNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcbiAgaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXRcbik7XG5cbnByb2ZpbGVFZGl0Rm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBFVkVOVCBMSVNURU5FUiBGT1IgUFJPRklMRSBFRElUXG5jb25zdGFudHMucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY29uc3QgZGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIGNvbnN0YW50cy5wcm9maWxlVGl0bGVJbnB1dC52YWx1ZSA9IGRhdGEubmFtZTtcbiAgY29uc3RhbnRzLnByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gZGF0YS5hYm91dDtcbiAgcHJvZmlsZUVkaXRGb3JtLm9wZW4oKTtcbn0pO1xuXG4vL0FWQVRBUiBVUERBVEVcblxuY29uc3QgcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2UtcGVuY2lsXCIpO1xuXG5wcm9maWxlQXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBpZiAoZS50YXJnZXQgPT09IGUuY3VycmVudFRhcmdldCkge1xuICAgIGF2YXRhckVkaXRQb3B1cC5vcGVuKCk7XG4gIH1cbn0pO1xuXG5jb25zdCBhdmF0YXJFZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjZWRpdC1hdmF0YXItbW9kYWxcIixcbiAgaGFuZGxlQXZhdGFyU3VibWl0XG4pO1xuYXZhdGFyRWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdCh7IGxpbmsgfSkge1xuICBhdmF0YXJFZGl0UG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLnVwZGF0ZUF2YXRhcihsaW5rKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFwiQXZhdGFyIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5OlwiLCByZXMpO1xuICAgICAgdXNlckluZm8uc2V0QXZhdGFyKGxpbmspO1xuICAgICAgYXZhdGFyRWRpdFBvcHVwLmNsb3NlKCk7XG4gICAgICBhdmF0YXJFZGl0UG9wdXAucmVzZXQoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igb2NjdXJyZWQgd2hpbGUgdXBkYXRpbmcgYXZhdGFyOlwiLCBlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgYXZhdGFyRWRpdFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIC8vICAgR0VUIENBUkRTXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7IGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMgfSkudGhlbihcbiAgICAgIChyZXMpID0+IHtcbiAgICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgLy9QT1NUIENBUkRTXG4gIGFkZENhcmQobmFtZSwgbGluaykge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBsaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gR0VUIFVTRVIgSU5GT1xuICBnZXRVc2VyKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHsgaGVhZGVyczogdGhpcy5faGVhZGVycyB9KS50aGVuKFxuICAgICAgKHJlcykgPT4ge1xuICAgICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfVxuICAgICk7XG4gIH1cblxuICAvL0VESVQgVVNFUiBJTkZPXG4gIGVkaXRQcm9maWxlKG5hbWUsIGFib3V0KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBhYm91dCB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBERUxFVEUgQ0FSRFNcbiAgZGVsZXRlUmVxdWVzdChjYXJkSUQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSUR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICAvL0FERCBMSUtFXG4gIGFkZExpa2UoY2FyZElEKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElEfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGlzTGlrZWQ6IHRydWUgfSksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgLy9SRU1PVkUgTElLRVxuICByZW1vdmVMaWtlKGNhcmRJRCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJRH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBpc0xpa2VkOiBmYWxzZSB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICAvL1VQREFURSBBVkFUQVJcbiAgdXBkYXRlQXZhdGFyKGF2YXRhcikge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcixcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIlxuICAgICk7XG4gICAgdGhpcy5faW1hZ2VDYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5tb2RhbF9fcHJldmlldy1jYXB0aW9uXCJcbiAgICApO1xuICB9XG5cbiAgb3Blbih7IG5hbWUsIGxpbmsgfSkge1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5zcmMgPSBsaW5rO1xuICAgIHRoaXMuX2ltYWdlRWxlbWVudC5hbHQgPSBuYW1lO1xuICAgIHRoaXMuX2ltYWdlQ2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKG5hbWUsIGFib3V0LCBhdmF0YXIpIHtcbiAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lKTtcbiAgICB0aGlzLl9hYm91dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYWJvdXQpO1xuICAgIHRoaXMuX2F2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIGNvbnN0IHVzZXJJbmZvID0ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcbiAgICAgIGFib3V0OiB0aGlzLl9hYm91dC50ZXh0Q29udGVudCxcbiAgICB9O1xuICAgIHJldHVybiB1c2VySW5mbztcbiAgfVxuXG4gIHNldFVzZXJJbmZvKG5hbWUsIGFib3V0KSB7XG4gICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5fYWJvdXQudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgfVxuXG4gIHNldEF2YXRhcihhdmF0YXIpIHtcbiAgICB0aGlzLl9hdmF0YXIuc3JjID0gYXZhdGFyO1xuICB9XG59XG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDYXJkIiwiaGFuZGxlTGlrZUJ1dHRvbiIsInRoaXMiLCJuYW1lIiwibGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9jYXJkSUQiLCJfaWQiLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIl9oYW5kbGVMaWtlQnV0dG9uIiwiaXNMaWtlZCIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiX2NhcmRFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsIl9kZWxldGVCdXR0b24iLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInByZXZlbnREZWZhdWx0IiwidGFyZ2V0IiwidGhlbiIsIl91cGRhdGVMaWtlQnV0dG9uIiwiY2F0Y2giLCJlcnJvciIsImNvbnNvbGUiLCJfY2FyZEltYWdlRWwiLCJyZW1vdmUiLCJnZXRWaWV3IiwiZG9jdW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2NhcmRUaXRsZUVsIiwic3JjIiwiYWx0IiwidGV4dENvbnRlbnQiLCJGb3JtVmFsaWRhdG9yIiwiY29uZmlnIiwiZm9ybUVsIiwiX2Zvcm1TZWxlY3RvciIsImZvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsIl9lcnJvck1lc3NhZ2VFbCIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJpbnB1dExpc3QiLCJzb21lIiwiX2Rpc2FibGVCdXR0b24iLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2lucHV0RWxzIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicmVzZXRWYWxpZGF0aW9uIiwiU2VjdGlvbiIsIl9yZWYiLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfcmVuZGVyZXIiLCJfaXRlbXMiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJyZXZlcnNlIiwiaXRlbSIsImFkZEl0ZW0iLCJwcmVwZW5kIiwicHJvZmlsZUVkaXRCdXR0b24iLCJlZGl0QXZhdGFyRm9ybSIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJwcm9maWxlRWRpdEZvcm0iLCJmb3JtcyIsImFkZENhcmRNb2RhbCIsImFkZENhcmRCdXR0b24iLCJwcmV2aWV3SW1hZ2VNb2RhbCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJfY2xvc2VCdXR0b24iLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwiX2hhbmRsZU92ZXJsYXlDbGljayIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJjdXJyZW50VGFyZ2V0Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX3N1Ym1pdEJ1dHRvblRleHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfaW5wdXRFbGVtZW50cyIsImlucHV0VmFsdWVzIiwidmFsdWUiLCJyZXNldCIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJsb2FkaW5nVGV4dCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImFkZENhcmQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImdldFVzZXIiLCJlZGl0UHJvZmlsZSIsImFib3V0IiwiZGVsZXRlUmVxdWVzdCIsImNhcmRJRCIsImFkZExpa2UiLCJyZW1vdmVMaWtlIiwidXBkYXRlQXZhdGFyIiwiYXZhdGFyIiwiYXV0aG9yaXphdGlvbiIsInByb2ZpbGVFZGl0VmFsaWRhdG9yIiwiY29uc3RhbnRzIiwiYWRkQ2FyZFZhbGlkYXRvciIsImNhcmRTZWN0aW9uIiwiY3JlYXRlQ2FyZCIsImNhcmREYXRhIiwiY2FyZEVsZW1lbnQiLCJlcnIiLCJhZGRDYXJkRm9ybSIsImZpbmFsbHkiLCJjYXJkUHJldmlldyIsIl9pbWFnZUVsZW1lbnQiLCJfaW1hZ2VDYXB0aW9uIiwiZGVsZXRlQ2FyZFBvcHVwIiwiY3VycmVudENhcmRJRCIsImN1cnJlbnRDYXJkRWxlbWVudCIsImxpa2VCdXR0b24iLCJsaWtlZFN0YXR1cyIsInVzZXJJbmZvIiwiX25hbWUiLCJfYWJvdXQiLCJfYXZhdGFyIiwiZ2V0VXNlckluZm8iLCJzZXRVc2VySW5mbyIsInNldEF2YXRhciIsImF2YXRhckVkaXRQb3B1cCIsImxvZyJdLCJzb3VyY2VSb290IjoiIn0=